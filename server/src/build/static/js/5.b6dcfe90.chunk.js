(this["webpackJsonpreact-hooks-context-authenticate"]=this["webpackJsonpreact-hooks-context-authenticate"]||[]).push([[5],{166:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return K}));var n=a(25),o=a.n(n),c=a(57),r=a(41),i=a(0),l=a.n(i),s=a(71),u=a(522),d=a(203),p=a(600),m=a.n(p),b=a(657),h=a.n(b),f=a(658),g=a.n(f),v=a(659),O=a.n(v),E=a(492),P=a(459),j=a(455),x=a(196),C=a(354),S=a(358),I=a(447),T=a(353),y=a(442),w=a(457),k=a(510),D=a(37),R=a(441),q=a(472),L=a(474),A=a(475),F=a(476),B=a(477);function N(e){let t=e.title,a=void 0===t?"Title":t,n=e.children,o=e.open,c=void 0!==o&&o,r=e.scroll,s=void 0===r?"paper":r,u=e.onClose,d=e.onSubmit,p=e.submitText,m=void 0===p?"Submit":p,b=e.onCancel,h=e.cancelText,f=void 0===h?"Cancel":h,g=e.isSubmitting,v=(e.resetForm,Object(D.a)(e,["title","children","open","scroll","onClose","onSubmit","submitText","onCancel","cancelText","isSubmitting","resetForm"]));const O=Object(i.useRef)(null);return Object(i.useEffect)(()=>{if(c){const e=O.current;null!==e&&e.focus()}},[c]),l.a.createElement(q.a,Object.assign({open:c,onClose:u,scroll:s,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},v,{fullWidth:!0,maxWidth:"xs"}),l.a.createElement(B.a,{id:"scroll-dialog-title"},a),l.a.createElement(A.a,{dividers:"paper"===s},l.a.createElement(F.a,{id:"scroll-dialog-description",ref:O,tabIndex:-1},n)),l.a.createElement(L.a,null,l.a.createElement(R.a,{onClick:b,color:"secondary"},f),l.a.createElement(R.a,{onClick:d,disabled:g,color:"primary"},m)))}var W=a(81),z=a(521);const G=z.b({coupon:z.d().required("Coupon is required").max(10,"Coupon must be at most 10 characters"),reason:z.d().required("Reason is required"),menuId:z.d().required("Menu is required"),isPublic:z.a()});var H=a(684);var M=a(549),U=a(550),J=a(64),V=a(229);const Y=Object(d.a)(e=>({breadcrumb:{padding:e.spacing(1)},content:{marginTop:e.spacing(2)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})),_="src.pages.invitation";function K(e){const t=Y(),a=Object(E.a)().t,n=Object(W.b)().getColor,d=Object(s.h)().pathname;let p=Object(M.a)("".concat(J.a.url,"/invitations"),!1,{params:{mine:!0,sortBy:"-createdAt"},responseDTO:U.b}),b=p.data,f=p.loading,v=p.onGet,D=p.onPost,R=p.onPatch,q=p.onDelete;const L=Object(V.b)().socketEmit,A=Object(i.useState)(null),F=Object(r.a)(A,2),B=F[0],z=F[1],K=Object(i.useState)(null),Q=Object(r.a)(K,2),X=Q[0],Z=Q[1],$=[{title:a("".concat(_,".Coupon")),field:"coupon"},{title:a("".concat(_,".Reason")),field:"reason"},{title:a("".concat(_,".Menu")),field:"menuId",lookup:{"phuc-long":"phuc-long","go-cafe":"go-cafe",highlands:"highlands"},render:e=>l.a.createElement(P.a,{style:{backgroundColor:(e=>{switch(e){case"go-cafe":return n("brown");case"highlands":return n("red");default:return n("green")}})(e.menuId)},color:"primary",label:e.menuId})},{title:a("".concat(_,".Public")),field:"isPublic"}],ee=Object(i.useState)(!1),te=Object(r.a)(ee,2),ae=te[0],ne=te[1];function oe(e){z(e),ne(!0)}function ce(){ne(!1),Z(null),fe()}function re(){return(re=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pe();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return(ie=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(X);case 2:t=e.sent,L("onChangeInvitation"),t&&console.log("delete with socket"),ce();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const le=Object(u.a)({initialValues:{coupon:Object(H.a)("1234567890abcdef",10)(),reason:"",menuId:"",isPublic:!1},validationSchema:G,onSubmit:function(){var e=Object(c.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!X){e.next=6;break}return e.next=3,R(X,t);case 3:a=e.sent,e.next=9;break;case 6:return e.next=8,D(t,{requestDTO:U.a});case 8:a=e.sent;case 9:L("onChangeInvitation"),a&&console.log("add with socket"),ce();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),se=le.values,ue=le.handleChange,de=le.handleBlur,pe=le.handleSubmit,me=le.errors,be=le.touched,he=le.isSubmitting,fe=le.resetForm,ge=le.setFieldValue;return l.a.createElement("div",null,l.a.createElement("div",{className:t.breadcrumb},l.a.createElement(k.a,{basename:"Dashboard",path:d},a("".concat(_,".Invitation")))),l.a.createElement("div",{className:t.content},l.a.createElement(m.a,{title:a("".concat(_,".InvitationList")),columns:$,data:b,isLoading:f,options:{filtering:!0,actionsColumnIndex:-1,grouping:!0,fixedColumns:{},pageSize:5,pageSizeOptions:[5,10]},actions:[{icon:()=>l.a.createElement(h.a,null),tooltip:a("".concat(_,".CreateInvitation")),isFreeAction:!0,onClick:e=>{oe("create")}},e=>({icon:()=>l.a.createElement(g.a,null),tooltip:a("".concat(_,".UpdateInvitation")),onClick:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(a.id);case 2:n=e.sent,ge("coupon",n.coupon),ge("reason",n.reason),ge("menuId",n.menuId),ge("isPublic",n.isPublic),Z(a.id),oe("update");case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}),e=>({icon:()=>l.a.createElement(O.a,null),tooltip:a("".concat(_,".DeleteInvitation")),onClick:(e,t)=>{Z(t.id),oe("delete")}})],editable:{},localization:{pagination:{labelDisplayedRows:"{from}-{to} ".concat(a(_+".of")," {count}"),labelRowsSelect:a("".concat(_,".rows")),firstAriaLabel:a("".concat(_,".FirstPage")),firstTooltip:a("".concat(_,".FirstPage")),previousAriaLabel:a("".concat(_,".PreviousPage")),previousTooltip:a("".concat(_,".PreviousPage")),nextAriaLabel:a("".concat(_,".NextPage")),nextTooltip:a("".concat(_,".NextPage")),lastAriaLabel:a("".concat(_,".LastPage")),lastTooltip:a("".concat(_,".LastPage"))},toolbar:{nRowsSelected:"{0} row(s) selected",searchTooltip:a("".concat(_,".Search")),searchPlaceholder:a("".concat(_,".Search"))},header:{actions:a("".concat(_,".Actions"))},body:{emptyDataSourceMessage:a("".concat(_,".NRTD")),filterRow:{filterTooltip:a("".concat(_,".Filter"))}},grouping:{placeholder:a("".concat(_,".DHHTGB"))}}})),l.a.createElement(N,{open:ae,onClose:ce,onCancel:ce,cancelText:a("".concat(_,".Cancel")),onSubmit:"create"===B?function(){pe()}:"update"===B?function(){return re.apply(this,arguments)}:function(){return ie.apply(this,arguments)},submitText:a("".concat(_,"create"===B?".Save":".OK")),isSubmitting:he,resetForm:fe,title:a("".concat(_,"create"===B?".NewInvitation":"update"===B?".UpdateInvitation":".DeleteInvitation")),maxWidth:"md"},"delete"!==B?l.a.createElement(i.Fragment,null,l.a.createElement(j.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"coupon",autoComplete:"coupon",id:me.coupon&&be.coupon?"standard-error-helper-text":"coupon",label:me.coupon&&be.coupon?"Error Coupon":a("".concat(_,".Coupon")),error:!(!me.coupon||!be.coupon),helperText:!(!me.coupon||!be.coupon)&&me.coupon,value:se.coupon,onChange:ue,onBlur:de}),l.a.createElement(j.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"reason",autoComplete:"reason",id:me.reason&&be.reason?"standard-error-helper-text":"reason",label:me.reason&&be.reason?"Error Reason":a("".concat(_,".Reason")),error:!(!me.reason||!be.reason),helperText:!(!me.reason||!be.reason)&&me.reason,value:se.reason,onChange:ue,onBlur:de}),l.a.createElement(x.a,{variant:"outlined",margin:"normal",fullWidth:!0,error:me.menuId},l.a.createElement(C.a,{id:"menu-label"},a("".concat(_,".Menu"))),l.a.createElement(S.a,{labelId:"menu-label",id:"menu",value:se.menuId,onChange:ue,label:a("".concat(_,".Menu")),inputProps:{name:"menuId",id:"menu-label"}},l.a.createElement(I.a,{value:""},l.a.createElement("em",null,"None")),l.a.createElement(I.a,{value:"phuc-long"},"Ph\xfac Long"),l.a.createElement(I.a,{value:"go-cafe"},"G\u1edd Cafe"),l.a.createElement(I.a,{value:"highlands"},"Highlands")),!(!me.menuId||!be.menuId)&&l.a.createElement(T.a,null,me.menuId)),l.a.createElement(x.a,{variant:"outlined",margin:"normal",fullWidth:!0,required:!0,error:!(!me.isPublic||!be.isPublic)&&me.isPublic,component:"fieldset"},l.a.createElement(y.a,{control:l.a.createElement(w.a,{value:"allowExtraEmails",color:"primary",checked:se.isPublic,onChange:()=>{ge("isPublic",!se.isPublic)}}),label:a("".concat(_,".Public"))}),!(!me.isPublic||!be.isPublic)&&l.a.createElement(T.a,null,me.isPublic))):a("".concat(_,".AYSYWTDTI"))))}},509:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e="")=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},510:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),o=a.n(n),c=a(44),r=a(491),i=a(55),l=a(492),s=a(509);function u({basename:e="",path:t="",formatLast:a=!1}){const n=Object(l.a)().t,u="".concat(e).concat(t).split("/");return o.a.createElement(r.a,{"aria-label":"breadcrumb"},u.map((e,t)=>{const r=Object(s.a)(e);return t===u.length-1?o.a.createElement(c.a,{key:t,color:"textPrimary"},a?r:n("src.components.Breadcrumb.".concat(r))):o.a.createElement(i.b,{key:t,to:"/".concat(e),style:{color:"inherit",textDecoration:"none"}},n("src.components.Breadcrumb.".concat(r)))}))}},549:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(25),o=a.n(n),c=a(225),r=a(57),i=a(41),l=a(0),s=a(221),u=a.n(s);const d={};function p(e,t,a){const n=Object(l.useState)([]),s=Object(i.a)(n,2),p=s[0],m=s[1],b=Object(l.useState)(!1),h=Object(i.a)(b,2),f=h[0],g=h[1],v=Object(l.useState)(),O=Object(i.a)(v,2),E=O[0],P=O[1],j=Object(l.useState)(0),x=Object(i.a)(j,2),C=x[0],S=x[1],I=localStorage.getItem("access-token"),T=u.a.create({baseURL:e,timeout:5e3,headers:{Authorization:"Bearer ".concat(I)}}),y=()=>{console.log("REFRESH:"),delete d[e],S(C+1)};Object(l.useEffect)(()=>{let n=!1;if(t)m(null),g(!1);else{(function(){var t=Object(r.a)(o.a.mark((function t(){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g(!0),d[e]?(r=d[e],m(r),g(!1)):T.get("/",Object(c.a)(Object(c.a)({},a),{},{transformResponse:[e=>a.responseDTO(JSON.parse(e))]})).then(e=>{n||m(e.data)}).catch(e=>{var t;e.response?P(null===(t=e.response)||void 0===t?void 0:t.data):P(e.message)}).finally(()=>g(!1));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}return()=>{n=!0}},[t,C]);return{data:p,setData:m,loading:f,error:E,refresh:y,onGet:e=>(console.log("GET:"),g(!0),new Promise((t,a)=>{T.get("/".concat(e)).then(e=>{200===e.status&&t(e.data)}).catch(e=>{var t;a(null===(t=e.response)||void 0===t?void 0:t.data)}).finally(()=>g(!1))})),onPost:(t,a)=>{console.log("POST:"),g(!0),T.post(e,t,Object(c.a)(Object(c.a)({},a),{},{transformRequest:[(e,t)=>a.requestDTO(e),...T.defaults.transformRequest]})).then(e=>{201===e.status&&y()}).catch(e=>{var t;e.response?P(null===(t=e.response)||void 0===t?void 0:t.data):P(e.message)}).finally(()=>g(!1))},onPut:(e,t)=>{console.log("PUT:"),g(!0),T.put("/".concat(e),t).then(e=>{200===e.status&&y()}).catch(e=>{var t;e.response?P(null===(t=e.response)||void 0===t?void 0:t.data):P(e.message)}).finally(()=>g(!1))},onPatch:(e,t)=>{console.log("PATCH:"),g(!0),T.patch("/".concat(e),t).then(e=>{200===e.status&&y()}).catch(e=>{var t;e.response?P(null===(t=e.response)||void 0===t?void 0:t.data):P(e.message)}).finally(()=>g(!1))},onDelete:e=>{console.log("DELETE:"),g(!0),T.delete("/".concat(e)).then(e=>{200===e.status&&y()}).catch(e=>{var t;e.response?P(null===(t=e.response)||void 0===t?void 0:t.data):P(e.message)}).finally(()=>g(!1))}}}},550:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r}));var n=a(225),o=a(37);const c=(e={})=>{const t=e.id,a=e.isPublic,c=Object(o.a)(e,["id","isPublic"]);return Object(n.a)({id:t,isPublic:a},c)},r=(e={})=>e.map(e=>((e={})=>{const t=e._id,a=e.isPublic,c=Object(o.a)(e,["_id","isPublic"]);return Object(n.a)({id:t,isPublic:a},c)})(e))}}]);
//# sourceMappingURL=5.b6dcfe90.chunk.js.map